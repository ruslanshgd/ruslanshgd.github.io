{{ $page := . }}
{{ $p := $page.Params }}
{{ if or $p.process_images $p.process_image $p.process_text }}
<section class="case-section">
  <h2>Процесс</h2>
  {{ with $p.process_text }}<p>{{ . }}</p>{{ end }}
  {{ if $p.process_images }}
    {{ range $p.process_images }}
      {{ $imgPath := "" }}
      {{ $caption := "" }}
      {{ if reflect.IsMap . }}
        {{ $imgPath = .image }}
        {{ $caption = .caption }}
      {{ else }}
        {{ $imgPath = . }}
      {{ end }}
      {{ if $imgPath }}
        {{ $imgRes := partial "get-image-resource.html" (dict "page" $page "path" $imgPath "context" "process") }}
        {{ if $imgRes }}
          <figure>
            <img src="{{ $imgRes.RelPermalink }}" alt="Процесс" style="max-width:100%; height:auto;">
            {{ if $caption }}<figcaption>{{ $caption }}</figcaption>{{ end }}
          </figure>
        {{ else }}
          <figure>
            <img src="{{ $imgPath | relURL }}" alt="Процесс" style="max-width:100%; height:auto;">
            {{ if $caption }}<figcaption>{{ $caption }}</figcaption>{{ end }}
          </figure>
        {{ end }}
      {{ end }}
    {{ end }}
  {{ else if $p.process_image }}
    {{ $imgRes := partial "get-image-resource.html" (dict "page" $page "path" $p.process_image "context" "process") }}
    {{ if $imgRes }}
      <p><img src="{{ $imgRes.RelPermalink }}" alt="Процесс" style="max-width:100%; height:auto;"></p>
    {{ else }}
      <p><img src="{{ $p.process_image | relURL }}" alt="Процесс" style="max-width:100%; height:auto;"></p>
    {{ end }}
  {{ end }}
</section>
{{ end }}
